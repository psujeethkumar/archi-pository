

### Containerized application best practices (for apps specific to Openshift Platform)

| <br /><br />Practice Name                                                                                                        | Explaination                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| :------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Keep application configuration outside of the image                                                                              | Container images that include environment-specific configuration cannot be promoted across environments (Dev, Test, Staging, Prod).<br />To achieve a reliable release process, the same image that was tested in the lower environments should be deployed into production.<br /><br />Keep the environment-specific configuration outside of the container image. For example, use ConfigMaps and Secrets to store the application configuration.                                                                                                                       |
| Specify the resource requests and<br />resource limits in the pod definitions.                                                   | Applications can run out of memory or incur CPU starvation due to improper configuration of requested resources.<br />Specifying the requested memory and CPU resources allows the cluster to make proper scheduling decisions to ensure that the application will have the requested resources available.                                                                                                                                                                                                                                                                |
| Always define liveness and<br />readiness probes in the pod definitions.                                                         | Health check probes allow the cluster to provide basic resiliency to your application.<br />Probes allows the cluster to restart your application (e.g.Â liveness probe failed), or avoid routing traffic to your application if it's not ready to serve requests (readiness probe).                                                                                                                                                                                                                                                                                      |
| Protect the application with pod disruption budgets                                                                              | There are situations where the application pods need to be evicted from the cluster node.<br />For example, the eviction is needed before the administrator can perform maintenance of the node or before the cluster autoscaler can remove the node from the cluster while downscaling. <br />To ensure that your application remains available when pods need to be evicted, you must define the respective PodDistruptionBudget objects.                                                                                                                               |
| Ensure that application pods terminate gracefully                                                                                | On termination, an application pod should complete all in-flight requests and terminate existing connections gracefully.<br />This allows for restarting the pod without end-users noticing, for example when a new version of the application is deployed.                                                                                                                                                                                                                                                                                                               |
| Run one process per container                                                                                                    | Avoid running multiple processes in a single container.<br />Running each process in a separate container allows for better isolation of processes, avoids issues with signal routing, and avoids the need for reaping the zombie processes                                                                                                                                                                                                                                                                                                                               |
| Implement application monitoring and alerting                                                                                    | Application monitoring and alerting are essential for keeping the application operating well in production and serving the business purpose.<br />Use monitoring tools like Prometheus & Grafana to monitor your application, which are usually provided in enterprise grade K8S clusters like Openshift.                                                                                                                                                                                                                                                                 |
| Configure the applications to write their logs to<br />stdout/stderr                                                             | OpenShift will collect those logs and send them to a centralized location (ELK, Splunk).<br />Application logs are an invaluable resource when analyzing production issues. <br />Alerting based on the content of the application logs helps ensure that the application is performing as expected.                                                                                                                                                                                                                                                                      |
| Consider implemting container design patterns like :<br />- Circuit breakers<br />- Timeouts<br />- Retries<br />- Rate limiting | The listed resiliency measures make your application perform better in the case of failures.<br />They protect your application from getting overloaded (rate limiting, circuit breakers), <br />and improve the performance when facing connectivity issues (timeouts, retries). <br />OpenShift Service Mesh which implements these measures without the need for code changes in your application.                                                                                                                                                                     |
| Use trusted base container images                                                                                                | Use vendor-provided container images where possible.<br />Vendor images are tested, hardened, and supported. <br />If using community-supported images, use only the images provided by the communities that you trust.<br />Avoid public repositories like duckerhub, quay.io etc.                                                                                                                                                                                                                                                                                       |
| Use the latest version of base container images                                                                                  | Only the latest versions of container images include all the available security fixes.<br />Set up CI pipeline to always pull the latest version of base images when building the application image. <br />Set up your CI pipeline to rebuild the application when updated base images become available                                                                                                                                                                                                                                                                   |
| Use a separate build image and runtime image                                                                                     | Creating a separate runtime image with minimum dependencies reduces the attack surface and produces a smaller runtime image.<br />The build image contains build dependencies that are required for building the application but are not required for running the application.Applications are vulnerable to breach where the attacker can take control of the application. Enforcing the use of the OpenShift restricted SCC provides the highest level of security that protects the cluster node from being compromised in the case that the application was breached. |
| Stick to the restricted security context constraint where applicable                                                             | Modify your container images to allow running under the restricted SecurityContextConstraint.<br />Applications are vulnerable to breach where the attacker can take control of the application. <br />Enforcing the use of the OpenShift restricted SCC provides the highest level of security that protects the cluster node from being compromised in the case that the application was breached.                                                                                                                                                                      |
| Protect the communication between application components using TLS.                                                              | Application components may communicate sensitive data that should be protected.<br />Unless you consider the underlying OpenShift network to be secure, you may want to leverage TLS to protect the traffic between the application components. <br />OpenShift Service Mesh can help by offloading the TLS management from the application.                                                                                                                                                                                                                              |
